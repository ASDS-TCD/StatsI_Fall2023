expenditure$Region
mean(expenditure$Region, expenditure$Y)
subset(expenditure, Y %in% '1'))
subset(expenditure, Y %in% 'Region$1'))
subset(expenditure, Y %in% 'Region$1')
subset(expenditure, Y %in% '1')
expenditure[expenditure&Region = '1']
expenditure[expenditure&Region == '1']
expenditure[expenditure&Region == '1']
expenditure[expenditure&Region == '1']
expenditure[expenditure$Region == '1']
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
mean_y_by_region <- tapply(your_data$Y, your_data$Region, mean)
mean_y_by_region <- tapply(expenditure$Y, expenditure$Region, mean)
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
mean_y_by_region <- tapply(expenditure$Y, expenditure$Region, mean)
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
mean_y_by_region1 <- tapply(expenditure$Y, expenditure$Region, mean)
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black"
)
par(mar=c(3,3,3,3))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black"
)
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
par(mar=c(3,3,3,3))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
par(mar=c(2,2,2,2))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
?legend
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black",
legend(x = "topleft", text.font = 4,
col= c("blue","orange"),text.col = "blue",
legend=c("Equation 1", "Equation 2")))
par(mar=c(4,4,4,4))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black",
legend(x = "topleft", text.font = 4,
col= c("blue","orange"),text.col = "blue",
legend=c("Equation 1", "Equation 2")))
legend(x = "topleft", text.font = 4,
col= c("blue","orange"),text.col = "blue",
legend=c("Equation 1", "Equation 2")))
legend(x = "topleft", text.font = 4,
col= c("blue","orange"),text.col = "blue",
legend=c("Equation 1", "Equation 2"))
legend(x = "topleft", text.font = 4,
text.col = "black",
legend=c(1=Northeast, 2= North Central, 3= South, 4=West))
legend(x = "topleft", text.font = 4,
text.col = "black",
legend=c(1 - Northeast, 2 - North Central, 3 -South, 4 - West))
legend(x = "topleft", text.font = 4,
text.col = "black",
legend=c(1Northeast, 2North Central, 3South, 4West))
legend(x = "topleft", text.font = 4,
text.col = "black",
legend=c(1Northeast, 2North Central, 3South, 4West))
legend(x = "topleft", text.font = 4,
text.col = "black",
legend=c(Northeast, North Central, South, West))
+                legend=c('1=Northeast', '2= North Central', '3= South', '4=West')
legend(x = "topleft", text.font = 4, col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'))
legend(x = "topleft", text.font = 2, col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'))
legend(x = "topleft", text.font = 4, col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'))
legend(x = "topleft", text.font = 4, text.size = 1, col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'))
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West', cex=0.5))
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West', cex=0,5))
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'), cex=0,5)
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'), cex = 0.5)
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'), cex = 0.5)
par(mar=c(4,4,4,4))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1=Northeast', '2= North Central', '3= South', '4=West'), cex = 0.5)
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1 = Northeast', '2 = North Central', '3 = South', '4 = West'), cex = 0.5)
par(mar=c(4,4,4,4))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
legend(x = "topleft", text.font = 4,  col= c("blue","orange"),text.col = "black", legend=c('1 = Northeast', '2 = North Central', '3 = South', '4 = West'), cex = 0.5)
par(mar=c(4,4,4,4))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
legend(x = "topleft", text.font = 4,text.col = "black", legend=c('1 = Northeast', '2 = North Central', '3 = South', '4 = West'), cex = 0.5)
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
northeast <- expenditure[expenditure$Region == 1]
expenditure <- read.table("https://raw.githubusercontent.com/ASDS-TCD/StatsI_Fall2023/main/datasets/expenditure.txt", header=T)
northeast <- expenditure[expenditure$Region == 1]
northeast <- expenditure[expenditure$Region == 1,]
north_east <- expenditure[expenditure$Region == 1,]
north_central <- expenditure[expenditure$Region == 2,]
south <- expenditure[expenditure$Region == 3,]
west <- expenditure[expenditure$Region == 4,]
mean(Y$north_east)
mean(north_east$Y)
mean(north_central$Y)
mean(south$Y)
mean(north_east$Y)
mean(north_central$Y)
mean(south$Y)
mean(west$Y)
plot(expenditure$X1, expenditure$Y, main = "YX1", ylab = 'Per capita state expenditure', xlab = 'Per capita personal income', col = c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = 'Financially insecure" residents (per 100,000)', col=c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = 'Financially insecure" residents (per 100,000)', col=c('green', 'blue'))
#YX1
plot(expenditure$X1, expenditure$Y, main = "YX1", ylab = 'Per capita state expenditure', xlab = 'Per capita personal income', col = c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = 'Financially insecure" residents (per 100,000)', col=c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = 'Financially insecure" residents (per 100,000)', col=c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = '№ of Financially insecure residents (per 100,000)', col=c('green', 'blue'))
#YX2
plot(expenditure$Y, expenditure$X2, main = "YX2", ylab = 'Per capita state expenditure', xlab = '№ of Financially insecure residents (per 100,000)', col=c('green', 'blue'))
#YX2
plot(expenditure$X2, expenditure$Y, main = "YX2", ylab = 'Per capita state expenditure', xlab = '№ of Financially insecure residents (per 100,000)', col=c('green', 'blue'))
#YX3
plot(expenditure$X3, expenditure$Y, main = "YX3", ylab = 'Per capita state expenditure', xlab = 'People in urban areas (per 1000)', col = c('green', 'blue'))
plot(expenditure$X1, expenditure$Y, main = "YX1", ylab = 'Per capita state expenditure', xlab = 'Per capita personal income', col = c('green', 'blue'))
abline(lm(y ~ x), col = "orange", lwd = 3)
abline(lm(y ~ x), col = "orange", lwd = 3)
abline(lm(expenditure$X1 ~ expenditure$Y), col = "orange", lwd = 3)
#YX1
plot(expenditure$X1, expenditure$Y, main = "YX1", ylab = 'Per capita state expenditure', xlab = 'Per capita personal income', col = c('green', 'blue'))
abline(lm(expenditure$X1 ~ expenditure$Y), col = "orange", lwd = 3)
#YX1
plot(expenditure$X1, expenditure$Y, main = "YX1", ylab = 'Per capita state expenditure', xlab = 'Per capita personal income', col = c('green', 'blue'), abline(lm(expenditure$X1 ~ expenditure$Y), col = "orange", lwd = 3))
cor(expenditure$X1, expenditure$Y)
#YX1
plot(expenditure$X1, expenditure$Y,
main = "YX1",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
col = c('green', 'blue'),
points(expenditure$X2, expenditure$Y, col = "green", pch = 19))
par(mar = c(4, 4, 4, 4))
#YX1
plot(expenditure$X1, expenditure$Y,
main = "YX1",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
col = c('green', 'blue'),
points(expenditure$X2, expenditure$Y, col = "black", pch = 19))
#YX1
plot(expenditure$X1, expenditure$Y,
main = "YX1",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
col = c('green', 'blue'),
points(expenditure$X2, expenditure$Y, col = "black", pch = 19))
col = c('green', 'blue')
plot(expenditure$X1, expenditure$Y,
main = "YX1",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
col = c('green', 'blue'))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
mean(north_east$Y)
mean(north_central$Y)
mean(south$Y)
mean(west$Y)
mean_y_by_region <- aggregate(Y ~ Region, data = expenditure, FUN = mean)
mean_y_by_region
mean1 <- mean(north_east$Y)
mean2 <- (north_central$Y)
mean3 <- (south$Y)
mean4 <- (west$Y)
mean1 <- mean(north_east$Y)
mean2 <- (north_central$Y)
mean3 <- (south$Y)
mean1 <- mean(north_east$Y)
mean2 <- mean(north_central$Y)
mean3 <- mean(south$Y)
mean4 <- mean(west$Y)
mean1>mean2
mean4>mean1, mean2, mean3
mean4>mean1
mean4>mean2
max(mean_y_by_region)
max(c(mean1,mean2,mean3,mean4)
means <- (c(mean1,mean2,mean3,mean4)
means <- (c(mean1,mean2,mean3,mean4))
max(means)
max(mean_y_by_region)
plot(
expenditure$X1,
expenditure$Y,
main = "YX1",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
pch = expenditure$Region,
col = c('green', 'blue', 'red', 'black')
)
#YX3
plot(expenditure$X3, expenditure$Y, main = "YX3", ylab = 'Per capita state expenditure', xlab = 'People in urban areas (per 1000)', col = c('green', 'blue'))
#YX3
plot(expenditure$Y, expenditure$X3, main = "YX3", ylab = 'Per capita state expenditure', xlab = 'People in urban areas (per 1000)', col = c('green', 'blue'))
#YX3
plot(expenditure$X3, expenditure$Y, main = "YX3", ylab = 'Per capita state expenditure', xlab = 'People in urban areas (per 1000)', col = c('green', 'blue'))
cor(expenditure$X3, expenditure$Y)
cor(expenditure$X2, expenditure$Y)
cor(expenditure$X1, expenditure$Y)
getwd()
setwd("C://Users//Administrator//Desktop//TCD ASDS//Applied Statistical Analysis I//StatsI_Fall2023//")
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c("stringr"),  pkgTest)
y <- c(105, 69, 86, 100, 82, 111, 104, 110, 87, 108, 87, 90, 94, 113, 112, 98, 80, 97, 95, 111, 114, 89, 95, 126, 98)
y <- c(105, 69, 86, 100, 82, 111, 104, 110, 87, 108, 87, 90, 94, 113, 112, 98, 80, 97, 95, 111, 114, 89, 95, 126, 98)
mean(y)
mean <- mean(y)
#2) Calculating standard deviation with the help of R function (the simple way)...
sd(y)
s <- sd(y)
#... or calculating standard deviation by ourselves as s=sqrt(sum((y - mean(y))^2)/(n - 1))
n <- length(y)
s1 <- sqrt(sum((y-mean(y))^2)/(n-1))
#We can see that the results are identical:
s
s1
#3) Calculating the standard error using the formula se=s/sqrt(n)
sd(y)/sqrt(n) #n being length(y)
se <- sd(y)/sqrt(n)
#4) Calculating how much area do we need under the curve (if CI=90%)...
#4.1) ... to the right? (1-Confidence Coefficient)/2
(1-.90)/2
right <- (1-.90)/2
right
#4.2) ... to the left? (1+Confidence Coefficient)/2
(1+.90)/2
left <- (1+.90)/2
left
(1.64+1.65)/2
z <- (1.64+1.65)/2
z
mean+(z*s/sqrt(n))
mean-(z*s/sqrt(n))
upper_90 <- mean+(z*s/sqrt(n))
lower_90 <- mean-(z*s/sqrt(n))
ConfidenceInterval90 <- c(lower_90, upper_90)
ConfidenceInterval90
length(y)
n <- length(y)
t <- (mean(y)-100)/se
df <- (n-1) #24
t <- (mean(y)-100)/se
df <- (n-1) #24
df
p <- pt((t), df = n-1, lower.tail=FALSE)
p1 <- pt(q=t, df=24, lower.tail=FALSE)
t_test <- t.test(y, mu=100, alternative="greater")
t_test
p>.05
p1>.05
#To interpret the Scatterplots better, I used resources like https://datavizcatalogue.com/methods/scatterplot.html
par(mar = c(4, 4, 4, 4))
#2.1.1:YX1
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
expenditure <- read.table("https://raw.githubusercontent.com/ASDS-TCD/StatsI_Fall2023/main/datasets/expenditure.txt", header=T)
par(mar = c(4, 4, 4, 4))
#2.1.1:YX1
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
lm_yx1 <- lm(expenditure$Y ~ expenditure$X1)
abline(lm_yx1, col = 'black')
cor(expenditure$X1, expenditure$Y)
plot(expenditure$X2, expenditure$Y,
main = "YX2",
xlab = 'Financially insecure residents (per 100,000)',
ylab = 'Per capita state expenditure',
col='green')
lm_yx2 <- lm(expenditure$Y ~ expenditure$X2)
abline(lm_yx1, col = 'black')
par(mar = c(4, 4, 4, 4))
plot(expenditure$X3,
expenditure$Y,
main = "YX3",
ylab = 'Per capita state expenditure',
xlab = 'People in urban areas (per 1000)',
col = 'darkred')
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_yx3 <- lm(expenditure$Y ~ expenditure$X3)
abline(lm_yx3, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X3, expenditure$Y)
par(mar = c(4, 4, 4, 4))
plot(expenditure$X1,
expenditure$X2,
main = "X1X2",
xlab = 'Per capita personal income',
ylab = 'Financially insecure residents (per 100,000)',
col = 'orange')
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_x1x2 <- lm(expenditure$X2 ~ expenditure$X1)
abline(lm_x1x2, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X1, expenditure$X2)
plot(expenditure$X1,
expenditure$X3,
main = "X1X3",
xlab = 'Per capita personal income',
ylab = 'People in urban areas (per 1000)',
col = 'purple')
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_x1x3 <- lm(expenditure$X3 ~ expenditure$X1)
abline(lm_x1x3, col = 'black')
cor(expenditure$X1, expenditure$X3)
plot(expenditure$X2,
expenditure$X3,
main = "X2X3",
xlab = 'Financially insecure residents (per 100,000)',
ylab = 'People in urban areas (per 1000)',
col = 'pink')
lm_x2x3 <- lm(expenditure$X3 ~ expenditure$X2)
abline(lm_x2x3, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X2, expenditure$X3)
par(mar=c(10,10,10,10))
pairs(expenditure[c("Y", "X1", "X2", "X3")],
main = "Scatterplot Matrix",
pch = 20,
col = "black"
)
par(mar=c(4,4,4,4))
boxplot(expenditure$Y~expenditure$Region,
data=expenditure,
main="Per capita state expenditure per region",
xlab="Region",
ylab="Per capita state expenditure",
col="green",
border="black")
legend(x = "topleft",
text.font = 4,
text.col = "black",
legend=c('1 = Northeast', '2 = North Central', '3 = South', '4 = West'),
cex = 0.5)
north_east <- expenditure[expenditure$Region == 1,]
north_central <- expenditure[expenditure$Region == 2,]
south <- expenditure[expenditure$Region == 3,]
west <- expenditure[expenditure$Region == 4,]
mean1 <- mean(north_east$Y)
mean2 <- mean(north_central$Y)
mean3 <- mean(south$Y)
mean4 <- mean(west$Y)
mean_y_by_region <- aggregate(Y~Region, data = expenditure, FUN = base::mean)
mean_y_by_region
max(mean_y_by_region)
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_yx1 <- lm(expenditure$Y ~ expenditure$X1)
abline(lm_yx1, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X1, expenditure$Y)
colors <- c('green', 'blue', 'red', 'black')
plot(
expenditure$X1,
expenditure$Y,
main = "YX1 by Region",
ylab = 'Per capita state expenditure',
xlab = 'Per capita personal income',
pch = expenditure$Region,
col = colors[expenditure$Region]
)
legend("topleft",
legend = unique(expenditure$Region),
pch = 1:length(unique(expenditure$Region)),
col = colors,
cex = 1,
title = "Region")
pdf('01.PS01_Skrypnyk_YX1plot')
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_yx1 <- lm(expenditure$Y ~ expenditure$X1)
abline(lm_yx1, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X1, expenditure$Y)
pdf('01.PS01_Skrypnyk_YX1plot.pdf')
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_yx1 <- lm(expenditure$Y ~ expenditure$X1)
abline(lm_yx1, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X1, expenditure$Y)
?dev.off
pdf('01.PS01_Skrypnyk_YX1plot.pdf')
dev.off()
plot(expenditure$X1, expenditure$Y,
main = "YX1",
xlab = 'Per capita personal income',
ylab = 'Per capita state expenditure',
col = 'blue',
xlim = c(min(expenditure$X1), max(expenditure$X1)),
ylim = c(min(expenditure$Y), max(expenditure$Y))
)
#Fitting a linear regression model with Y as the dependent variable
#and adding the LR line to the plot:
lm_yx1 <- lm(expenditure$Y ~ expenditure$X1)
abline(lm_yx1, col = 'black')
#Calculating correlation coefficient:
cor(expenditure$X1, expenditure$Y)
